<h2>Your Pok√©mon Collection</h2>

<!-- Search Form -->
<form method="get" action="{% url 'collection' %}">
    <input type="text" name="search" placeholder="Search Pok√©mon by name" value="{{ request.GET.search }}">
    <button type="submit">Search</button>
</form>

<!-- Sorting Options -->
<form method="get" action="{% url 'collection' %}">
    <label for="sort_by">Sort by:</label>
    <select name="sort_by" id="sort_by" onchange="this.form.submit()">
        <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Name</option>
        <option value="type" {% if sort_by == 'type' %}selected{% endif %}>Type</option>
        <option value="date" {% if sort_by == 'date' %}selected{% endif %}>Date Received</option>
    </select>
</form>

<!-- Display the search query -->
{% if request.GET.search %}
    <p>Showing results for: <strong>{{ request.GET.search }}</strong></p>
{% endif %}

<ul>
    {% for pokemon in pokemons %}
        <li>
            <div style="display:flex; align-items: center; gap: 10px;">
                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/{{ pokemon.poke_id }}.png" style="width: 100px; height: auto;">
                <div>
                    <strong>{{ pokemon.name }}</strong> ({{ pokemon.type }})
                    {% if pokemon.is_favorite %}
                        <span>‚ù§Ô∏è</span>
                    {% else %}
                        <a href="{% url 'toggle_favorite' pokemon.id %}">üíî</a>
                    {% endif %}
                    <p><a href="{% url 'owned_pokemon_detail' pokemon.id %}">View Details</a></p>
                </div>
            </div>
        </li>
    {% empty %}
        <li>No Pok√©mon found matching your search.</li>
    {% endfor %}
</ul>

<!-- If your collection is empty, show a button to populate it. -->
{% if pokemons|length == 0 %}
<form method="post" action="{% url 'populate_collection' %}">
    {% csrf_token %}
    <button type="submit">Add Random Pok√©mon to My Collection</button>
</form>
{% endif %}

<p>
    <a href="{% url 'incoming_trade_offers' %}">Incoming Trade Offers</a> |
    <a href="{% url 'outgoing_trade_offers' %}">Outgoing Trade Offers</a> |
    <a href="{% url 'marketplace' %}">Marketplace</a> |
    <a href="{% url 'trade_history' %}">Trade History</a>
</p>